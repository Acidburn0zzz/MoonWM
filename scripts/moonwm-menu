#!/bin/sh

rightmenu="  Applications
$(moonwm-xdg-xmenu | sed -e 's/^/	/')

  Shutdown			poweroff || sudo poweroff
  Reboot			reboot || sudo reboot
  Suspend			moonwm-util lock; loginctl suspend || systemctl suspend

  Reload MoonWM	moonie restartlaunched
  Log out			moonie quit"

appsmenu="  Terminal			$TERMINAL"
command -v $BROWSER > /dev/null 2>&1    && appsmenu="$appsmenu
  Web				$BROWSER"
command -v mpv > /dev/null 2>&1         && appsmenu="$appsmenu
  Media			mpv"
command -v $FILEMANAGER > /dev/null 2>&1 && appsmenu="$appsmenu
  Files			$FILEMANAGER"
command -v discord > /dev/null 2>&1     && appsmenu="$appsmenu
ﭮ  Discord			discord"
command -v spotify > /dev/null 2>&1     && appsmenu="$appsmenu
  Spotify			if pidof spotify; then moonie toggleview 7; else spotify; fi"
command -v thunderbird > /dev/null 2>&1 && appsmenu="$appsmenu
  Mail				thunderbird"

contextmenu="  Close			moonie killclient
ﭔ  Resize			moonie rioresize
  Floating			moonie togglefloating
  Fullscreen		moonie togglefullscr"


case $1 in
    # 1) rofi -show drun -config ~/.config/rofi/apps.rasi -fullscreen ;;
    # 1) moonwm-xdg-xmenu | xmenu -p 0x0 | sh ;;
    1) pidof skippy-xd || skippy-xd > /dev/null 2>&1 ;;
    2) echo "$appsmenu" | xmenu -p 0x0:current | sh ;;
    3) echo "$rightmenu" | xmenu -p 0x0:current | sh; nice moonwm-xdg-xmenu -u & ;;
    "context")
        selection="$(echo "$contextmenu" | xmenu)"
        [ -z "$selection" ] && exit
        wid="$(slop -b 0 -f %i)"
        [ -z "$wid" ] && exit
        timeout -k 3s 3s xdotool windowactivate --sync "$wid" || exit
		echo "$selection" | sh
		;;
esac

