#!/bin/sh

rightmenu="  Applications
$(moonwm-xdg-xmenu | sed -e 's/^/	/')

  Shutdown			poweroff || sudo poweroff
  Reboot			reboot || sudo reboot
  Suspend			moonwm-util lock; loginctl suspend || systemctl suspend

  Reload MoonWM	moonie rquit
  Log out			moonie quit"

appsmenu="  Terminal			$TERMINAL"
command -v $BROWSER > /dev/null 2>&1    && appsmenu="$appsmenu
  Web				$BROWSER"
command -v mpv > /dev/null 2>&1         && appsmenu="$appsmenu
  Media			mpv"
command -v $FILEMANAGER > /dev/null 2>&1 && appsmenu="$appsmenu
  Files			$FILEMANAGER"
command -v discord > /dev/null 2>&1     && appsmenu="$appsmenu
ﭮ  Discord			discord"
command -v spotify > /dev/null 2>&1     && appsmenu="$appsmenu
  Spotify			if pidof spotify; then moonie toggleview 7; else spotify; fi"
command -v thunderbird > /dev/null 2>&1 && appsmenu="$appsmenu
  Mail				thunderbird"

contextmenu="  Close			xdotool windowactivate \$(slop -b 0 -f %i); moonie killclient
ﭔ  Resize			xdotool windowactivate \$(slop -b 0 -f %i); moonie rioresize
  Floating			xdotool windowactivate \$(slop -b 0 -f %i); moonie togglefloating
  Fullscreen		xdotool windowactivate \$(slop -b 0 -f %i); moonie togglefullscr"


case $1 in
    # 1) rofi -show drun -config ~/.config/rofi/apps.rasi -fullscreen ;;
    # 1) moonwm-xdg-xmenu | xmenu -p 0x0 | sh ;;
    1) pidof skippy-xd || skippy-xd > /dev/null 2>&1 ;;
    2) echo "$appsmenu" | xmenu -p 0x0:current | sh ;;
    3) echo "$rightmenu" | xmenu -p 0x0:current | sh ;;
    "context") echo "$contextmenu" | xmenu | sh ;;
esac

nice moonwm-xdg-xmenu -u &
